import { HttpResponse, http } from "msw";

const SUCCESS_CODE = "0000000000";

const allMenus = [
	{
		id: "dashboard",
		code: "dashboard",
		title: "仪表盘",
		url: "/dashboard",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		isHome: true,
		keepAlive: true,
		permissions: [],
		order: 1,
		isActive: true,
		status: "enabled" as const,
		badge: { color: "success", text: "新" },
	},
	{
		id: "overview",
		code: "overview",
		title: "概览",
		url: "/overview",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 2,
		isActive: true,
		status: "enabled" as const,
		badge: { type: "dot", color: "success" },
	},
	{
		id: "features",
		code: "features",
		title: "功能特性",
		url: "/features",
		type: "dir" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 3,
		isActive: true,
		status: "enabled" as const,
		category: "application" as const,
		badge: { type: "dot", color: "success" },
		children: [
			{
				id: "features-move",
				code: "features-move",
				title: "移动",
				url: "/features/move",
				type: "menu" as const,
				icon: "",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 1,
				isActive: true,
				status: "enabled" as const,
			},
			{
				id: "features-resize",
				code: "features-resize",
				title: "调整大小",
				url: "/features/resize",
				type: "menu" as const,
				icon: "",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 2,
				isActive: true,
				status: "enabled" as const,
				badge: { type: "text", text: "HOT", color: "warning" },
			},
			{
				id: "features-panel-controls",
				code: "features-panel-controls",
				title: "面板控制",
				url: "/features/panel-controls",
				type: "menu" as const,
				icon: "",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 3,
				isActive: true,
				status: "enabled" as const,
				badge: { type: "badge", color: "destructive", text: "99+" },
			},
		],
	},
	{
		id: "multi-level",
		code: "multi-level",
		title: "多级菜单",
		url: "/multi-level",
		type: "dir" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 4,
		isActive: true,
		status: "enabled" as const,
		category: "application" as const,
		children: [
			{
				id: "level2-1",
				code: "level2-1",
				title: "二级菜单-1",
				type: "dir" as const,
				icon: "",
				parentId: "multi-level",
				parentCode: "multi-level",
				hidden: false,
				order: 1,
				isActive: true,
				status: "enabled" as const,
				children: [
					{
						id: "level3-1-1",
						code: "level3-1-1",
						title: "三级菜单-1-1",
						url: "/multi-level/level2-1/level3-1-1",
						type: "menu" as const,
						icon: "",
						parentId: "level2-1",
						parentCode: "level2-1",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 1,
						isActive: true,
						status: "enabled" as const,
					},
					{
						id: "level3-1-2",
						code: "level3-1-2",
						title: "三级菜单-1-2",
						type: "dir" as const,
						icon: "",
						parentId: "level2-1",
						parentCode: "level2-1",
						hidden: false,
						order: 2,
						isActive: true,
						status: "enabled" as const,
						children: [
							{
								id: "level4-1-2-1",
								code: "level4-1-2-1",
								title: "四级菜单-1-2-1",
								url: "/multi-level/level2-1/level3-1-2/level4-1-2-1",
								type: "menu" as const,
								icon: "",
								parentId: "level3-1-2",
								parentCode: "level3-1-2",
								hidden: false,
								openMode: "currentSystemTab" as const,
								permissions: [],
								order: 1,
								isActive: true,
								status: "enabled" as const,
							},
							{
								id: "level4-1-2-2",
								code: "level4-1-2-2",
								title: "四级菜单-1-2-2",
								url: "/multi-level/level2-1/level3-1-2/level4-1-2-2",
								type: "menu" as const,
								icon: "",
								parentId: "level3-1-2",
								parentCode: "level3-1-2",
								hidden: false,
								openMode: "currentSystemTab" as const,
								permissions: [],
								order: 2,
								isActive: true,
								status: "enabled" as const,
								badge: { type: "badge", color: "default", text: "12" },
							},
						],
					},
					{
						id: "level3-1-3",
						code: "level3-1-3",
						title: "三级菜单-1-3",
						url: "/multi-level/level2-1/level3-1-3",
						type: "menu" as const,
						icon: "",
						parentId: "level2-1",
						parentCode: "level2-1",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 3,
						isActive: true,
						status: "enabled" as const,
					},
				],
			},
			{
				id: "level2-2",
				code: "level2-2",
				title: "二级菜单-2",
				type: "dir" as const,
				icon: "",
				parentId: "multi-level",
				parentCode: "multi-level",
				hidden: false,
				order: 2,
				isActive: true,
				status: "enabled" as const,
				children: [
					{
						id: "level3-2-1",
						code: "level3-2-1",
						title: "三级菜单-2-1",
						url: "/multi-level/level2-2/level3-2-1",
						type: "menu" as const,
						icon: "",
						parentId: "level2-2",
						parentCode: "level2-2",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 1,
						isActive: true,
						status: "enabled" as const,
						badge: { type: "text", text: "VIP", color: "custom", customColor: "#8b5cf6" },
					},
				],
			},
			{
				id: "level2-3",
				code: "level2-3",
				title: "二级菜单-3",
				url: "/multi-level/level2-3",
				type: "menu" as const,
				icon: "",
				parentId: "multi-level",
				parentCode: "multi-level",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 3,
				isActive: true,
				status: "enabled" as const,
				badge: { color: "custom", text: "BETA", customColor: "#ec4899" },
			},
		],
	},
];

const partialMenus = [
	{
		id: "dashboard",
		code: "dashboard",
		title: "仪表盘",
		url: "/dashboard",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		isHome: true,
		keepAlive: true,
		permissions: [],
		order: 1,
		isActive: true,
		status: "enabled" as const,
		badge: { color: "success", text: "新" },
	},
	{
		id: "overview",
		code: "overview",
		title: "概览",
		url: "/overview",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 2,
		isActive: true,
		status: "enabled" as const,
		badge: { type: "badge", color: "primary", value: "30" },
	},
];

export default [
	http.get("/api/rap/user/menus", ({ request }) => {
		const token = request.headers.get("authorization") ?? "";
		if (!token) {
			return HttpResponse.json(
				{ code: "401", message: "unauthorized", data: null },
				{ status: 401, statusText: "unauthorized" },
			);
		}
		const username = token.split(" ")[1] || "";
		if (username !== "admin") {
			return HttpResponse.json({ code: SUCCESS_CODE, message: "success", data: partialMenus });
		} else {
			return HttpResponse.json({ code: SUCCESS_CODE, message: "success", data: allMenus });
		}
	}),
];
