import { HttpResponse, http } from "msw";

const SUCCESS_CODE = "0000000000";

const allMenus = [
	{
		id: "dashboard",
		code: "dashboard",
		title: "仪表盘",
		url: "/dashboard",
		type: "menu" as const,
		icon: "ri:dashboard-3-line",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		isHome: true,
		keepAlive: true,
		permissions: [],
		order: 1,
		isActive: true,
		status: "enabled" as const,
		badge: { color: "success", text: "新" },
	},
	{
		id: "overview",
		code: "overview",
		title: "概览",
		url: "/overview",
		type: "menu" as const,
		icon: "rap-icon:overview",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 2,
		isActive: true,
		status: "enabled" as const,
		badge: { type: "dot", color: "success" },
	},
	{
		id: "components",
		code: "components",
		title: "组件",
		url: "/components",
		type: "dir" as const,
		icon: "lucide:component",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 3,
		isActive: true,
		status: "enabled" as const,
		category: "application" as const,
		badge: { type: "dot", color: "success" },
		children: [
			{
				id: "tree",
				code: "tree",
				title: "树组件",
				url: "/components/tree",
				type: "menu" as const,
				icon: "lucide:list-tree",
				parentId: "components",
				parentCode: "components",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 1,
				isActive: true,
				status: "enabled" as const,
			}
		],
	},
	{
		id: "features",
		code: "features",
		title: "功能特性",
		url: "/features",
		type: "dir" as const,
		icon: "rap-icon:features",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 3,
		isActive: true,
		status: "enabled" as const,
		category: "application" as const,
		badge: { type: "dot", color: "success" },
		children: [
			{
				id: "features-move",
				code: "features-move",
				title: "移动",
				url: "/features/move",
				type: "menu" as const,
				icon: "lucide:move",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 1,
				isActive: true,
				status: "enabled" as const,
			},
			{
				id: "features-resize",
				code: "features-resize",
				title: "调整大小",
				url: "/features/resize",
				type: "menu" as const,
				icon: "lucide:move-horizontal",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 2,
				isActive: true,
				status: "enabled" as const,
				badge: { type: "text", text: "HOT", color: "warning" },
			},
			{
				id: "features-panel-controls",
				code: "features-panel-controls",
				title: "面板控制",
				url: "/features/panel-controls",
				type: "menu" as const,
				icon: "rap-icon:mini-max",
				parentId: "features",
				parentCode: "features",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 3,
				isActive: true,
				status: "enabled" as const,
				badge: { type: "badge", color: "destructive", text: "99+" },
			},
		],
	},
	{
		id: "nested-menu",
		code: "nested-menu",
		title: "嵌套菜单",
		url: "/nested-menu",
		type: "dir" as const,
		icon: "lucide:menu",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 4,
		isActive: true,
		status: "enabled" as const,
		category: "application" as const,
		children: [
			{
				id: "nested-menu-1",
				code: "nested-menu-1",
				title: "二级菜单-1",
				type: "dir" as const,
				icon: "ri:menu-add-line",
				parentId: "nested-menu",
				parentCode: "nested-menu",
				hidden: false,
				order: 1,
				isActive: true,
				status: "enabled" as const,
				children: [
					{
						id: "nested-menu-1-1",
						code: "nested-menu-1-1",
						title: "三级菜单-1-1",
						url: "/nested-menu/nested-menu-1/nested-menu-1-1",
						type: "menu" as const,
						icon: "ri:menu-4-line",
						parentId: "nested-menu-1",
						parentCode: "nested-menu-1",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 1,
						isActive: true,
						status: "enabled" as const,
					},
					{
						id: "nested-menu-1-2",
						code: "nested-menu-1-2",
						title: "三级菜单-1-2",
						type: "dir" as const,
						icon: "ri:menu-unfold-3-line",
						parentId: "nested-menu-1",
						parentCode: "nested-menu-1",
						hidden: false,
						order: 2,
						isActive: true,
						status: "enabled" as const,
						children: [
							{
								id: "nested-menu-1-2-1",
								code: "nested-menu-1-2-1",
								title: "四级菜单-1-2-1",
								url: "/nested-menu/nested-menu-1/nested-menu-1-2/nested-menu-1-2-1",
								type: "menu" as const,
								icon: "ri:menu-5-line",
								parentId: "nested-menu-1-2",
								parentCode: "nested-menu-1-2",
								hidden: false,
								openMode: "currentSystemTab" as const,
								permissions: [],
								order: 1,
								isActive: true,
								status: "enabled" as const,
							},
							{
								id: "nested-menu-1-2-2",
								code: "nested-menu-1-2-2",
								title: "四级菜单-1-2-2",
								url: "/nested-menu/nested-menu-1/nested-menu-1-2/nested-menu-1-2-2",
								type: "menu" as const,
								icon: "ri:menu-5-line",
								parentId: "nested-menu-1-2",
								parentCode: "nested-menu-1-2",
								hidden: false,
								openMode: "currentSystemTab" as const,
								permissions: [],
								order: 2,
								isActive: true,
								status: "enabled" as const,
								badge: { type: "badge", color: "default", text: "12" },
							},
						],
					},
					{
						id: "nested-menu-1-3",
						code: "nested-menu-1-3",
						title: "三级菜单-1-3",
						url: "/nested-menu/nested-menu-1/nested-menu-1-3",
						type: "menu" as const,
						icon: "ri:menu-4-line",
						parentId: "nested-menu-1",
						parentCode: "nested-menu-1",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 3,
						isActive: true,
						status: "enabled" as const,
					},
				],
			},
			{
				id: "nested-menu-2",
				code: "nested-menu-2",
				title: "二级菜单-2",
				type: "dir" as const,
				icon: "ri:menu-add-line",
				parentId: "nested-menu",
				parentCode: "nested-menu",
				hidden: false,
				order: 2,
				isActive: true,
				status: "enabled" as const,
				children: [
					{
						id: "nested-menu-2-1",
						code: "nested-menu-2-1",
						title: "三级菜单-2-1",
						url: "/nested-menu/nested-menu-2/nested-menu-2-1",
						type: "menu" as const,
						icon: "ri:menu-3-line",
						parentId: "nested-menu-2",
						parentCode: "nested-menu-2",
						hidden: false,
						openMode: "currentSystemTab" as const,
						permissions: [],
						order: 1,
						isActive: true,
						status: "enabled" as const,
						badge: { type: "text", text: "VIP", color: "custom", customColor: "#8b5cf6" },
					},
				],
			},
			{
				id: "nested-menu-3",
				code: "nested-menu-3",
				title: "二级菜单-3",
				url: "/nested-menu/nested-menu-3",
				type: "menu" as const,
				icon: "ri:menu-2-line",
				parentId: "nested-menu",
				parentCode: "nested-menu",
				hidden: false,
				openMode: "currentSystemTab" as const,
				permissions: [],
				order: 3,
				isActive: true,
				status: "enabled" as const,
				badge: { color: "custom", text: "BETA", customColor: "#ec4899" },
			},
		],
	},
];

const partialMenus = [
	{
		id: "dashboard",
		code: "dashboard",
		title: "仪表盘",
		url: "/dashboard",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		isHome: true,
		keepAlive: true,
		permissions: [],
		order: 1,
		isActive: true,
		status: "enabled" as const,
		badge: { color: "success", text: "新" },
	},
	{
		id: "overview",
		code: "overview",
		title: "概览",
		url: "/overview",
		type: "menu" as const,
		icon: "",
		parentId: null,
		parentCode: null,
		hidden: false,
		openMode: "currentSystemTab" as const,
		permissions: [],
		order: 2,
		isActive: true,
		status: "enabled" as const,
		badge: { type: "badge", color: "primary", value: "30" },
	},
];

export default [
	http.get("/api/rap/user/menus", ({ request }) => {
		const token = request.headers.get("authorization") ?? "";
		if (!token) {
			return HttpResponse.json(
				{ code: "401", message: "unauthorized", data: null },
				{ status: 401, statusText: "unauthorized" },
			);
		}
		const username = token.split(" ")[1] || "";
		if (username !== "admin") {
			return HttpResponse.json({ code: SUCCESS_CODE, message: "success", data: partialMenus });
		} else {
			return HttpResponse.json({ code: SUCCESS_CODE, message: "success", data: allMenus });
		}
	}),
];
